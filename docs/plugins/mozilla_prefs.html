<!DOCTYPE html>
<html lang="fr">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1.0">
        <title>Documentation: plugins_utils/mozilla_prefs_commands.py</title>
        <link rel="stylesheet"
              href="docs_style.css">
    </head>

    <body>
        <div class="container">

            <h1 class="main-title">Documentation: <code>plugins_utils/mozilla_prefs_commands.py</code></h1>

            <p class="module-description">
                Ce module fournit des utilitaires pour la gestion complète des fichiers de configuration et préférences des applications Mozilla (Firefox, Thunderbird).
                Il offre des fonctionnalités avancées pour lire, écrire et manipuler les fichiers prefs.js, user.js, mozilla.cfg, policies.json et autres fichiers de configuration.
            </p>
            <p class="dependency-warning">
                Nécessite Python 3.6+ et hérite de <code>ConfigFileCommands</code> pour les opérations de base sur les fichiers.
            </p>

            <nav class="toc">
                <h3 class="toc-title">Accès Rapide aux Méthodes</h3>
                <ul class="toc-list">
                    <li class="toc-item"><a href="#read_prefs_file"
                           class="toc-link">read_prefs_file</a></li>
                    <li class="toc-item"><a href="#write_prefs_file"
                           class="toc-link">write_prefs_file</a></li>
                    <li class="toc-item"><a href="#get_pref"
                           class="toc-link">get_pref</a></li>
                    <li class="toc-item"><a href="#set_pref"
                           class="toc-link">set_pref</a></li>
                    <li class="toc-item"><a href="#find_profile_path"
                           class="toc-link">find_profile_path</a></li>
                    <li class="toc-item"><a href="#configure_firefox_enterprise_policies"
                           class="toc-link">configure_firefox_enterprise_policies</a></li>
                    <li class="toc-item"><a href="#configure_thunderbird_proxy"
                           class="toc-link">configure_thunderbird_proxy</a></li>
                    <li class="toc-item"><a href="#configure_thunderbird_filters"
                           class="toc-link">configure_thunderbird_filters</a></li>
                    <li class="toc-item"><a href="#read_cfg_file"
                           class="toc-link">read_cfg_file</a></li>
                    <li class="toc-item"><a href="#write_cfg_file"
                           class="toc-link">write_cfg_file</a></li>
                    <li class="toc-item"><a href="#read_policies_json"
                           class="toc-link">read_policies_json</a></li>
                    <li class="toc-item"><a href="#update_lightning_calendar"
                           class="toc-link">update_lightning_calendar</a></li>
                    <li class="toc-item"><a href="#configure_autoconfig"
                           class="toc-link">configure_autoconfig</a></li>
                </ul>
            </nav>

            <h2 class="section-title">Classe Principale</h2>

            <section class="method-section">
                <h3 class="method-title"
                    id="MozillaPrefsCommands"><code>MozillaPrefsCommands(ConfigFileCommands)</code></h3>
                <p class="description">
                    Classe pour manipuler les fichiers de préférences Mozilla (Firefox, Thunderbird).
                    Hérite de <code>ConfigFileCommands</code> pour réutiliser ses fonctionnalités de base.
                    Gère les fichiers prefs.js, user.js, mozilla.cfg, policies.json et autres configurations.
                </p>
            </section>

            <h2 class="section-title">Méthodes de Gestion des Préférences</h2>

            <section class="method-section">
                <h4 class="method-title"
                    id="read_prefs_file">
                    <code>read_prefs_file(path: Union[str, Path]) -> Optional[Dict[str, Any]]</code>
                </h4>
                <p class="description">Lit un fichier de préférences Mozilla (prefs.js ou user.js).</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Optional[Dict[str, Any]]</span> - Dictionnaire des préférences {nom: valeur} ou None en cas d'erreur.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="write_prefs_file"><code>write_prefs_file(path: Union[str, Path], prefs: Dict[str, Any], backup: bool = True) -> bool</code></h4>
                <p class="description">Écrit un dictionnaire de préférences dans un fichier prefs.js ou user.js.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                    <dt>prefs</dt>
                    <dd><span class="param-type">(Dict[str, Any])</span>: Dictionnaire des préférences {nom: valeur}.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si l'écriture réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="get_pref"><code>get_pref(path: Union[str, Path], pref_name: str, default: Any = None) -> Any</code></h4>
                <p class="description">Récupère une préférence spécifique d'un fichier de préférences.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                    <dt>pref_name</dt>
                    <dd><span class="param-type">(str)</span>: Nom de la préférence à récupérer.</dd>
                    <dt>default</dt>
                    <dd><span class="param-type">(Any)</span>: Valeur par défaut si la préférence n'existe pas.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Any</span> - Valeur de la préférence ou valeur par défaut.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="set_pref"><code>set_pref(path: Union[str, Path], pref_name: str, value: Any, backup: bool = True) -> bool</code></h4>
                <p class="description">Définit une préférence dans un fichier de préférences.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                    <dt>pref_name</dt>
                    <dd><span class="param-type">(str)</span>: Nom de la préférence à définir.</dd>
                    <dt>value</dt>
                    <dd><span class="param-type">(Any)</span>: Nouvelle valeur de la préférence.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la modification réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="remove_pref"><code>remove_pref(path: Union[str, Path], pref_name: str, backup: bool = True) -> bool</code></h4>
                <p class="description">Supprime une préférence d'un fichier de préférences.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                    <dt>pref_name</dt>
                    <dd><span class="param-type">(str)</span>: Nom de la préférence à supprimer.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la suppression réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="get_prefs_by_prefix"><code>get_prefs_by_prefix(path: Union[str, Path], prefix: str) -> Dict[str, Any]</code></h4>
                <p class="description">Récupère toutes les préférences dont le nom commence par un préfixe spécifique.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                    <dt>prefix</dt>
                    <dd><span class="param-type">(str)</span>: Préfixe des noms de préférences à récupérer.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Dict[str, Any]</span> - Dictionnaire des préférences filtrées {nom: valeur}.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="set_multiple_prefs"><code>set_multiple_prefs(path: Union[str, Path], prefs_to_set: Dict[str, Any], backup: bool = True) -> bool</code></h4>
                <p class="description">Définit plusieurs préférences en une seule opération.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                    <dt>prefs_to_set</dt>
                    <dd><span class="param-type">(Dict[str, Any])</span>: Dictionnaire des préférences à définir {nom: valeur}.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la modification réussit, False sinon.
                </div>
            </section>

            <h2 class="section-title">Gestion des Profils</h2>

            <section class="method-section">
                <h4 class="method-title"
                    id="find_profile_path"><code>find_profile_path(app_name: str = "thunderbird", profile_name: Optional[str] = None) -> Optional[Path]</code></h4>
                <p class="description">Trouve le chemin d'un profil Mozilla.</p>
                <dl class="param-list">
                    <dt>app_name</dt>
                    <dd><span class="param-type">(str)</span>: Nom de l'application ("thunderbird" ou "firefox"). Défaut: "thunderbird".</dd>
                    <dt>profile_name</dt>
                    <dd><span class="param-type">(Optional[str])</span>: Nom du profil à rechercher ou None pour utiliser le profil par défaut.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Optional[Path]</span> - Chemin du profil ou None si non trouvé.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="backup_prefs_file"><code>backup_prefs_file(path: Union[str, Path]) -> Optional[str]</code></h4>
                <p class="description">Crée une sauvegarde d'un fichier de préférences.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de préférences.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Optional[str]</span> - Chemin de la sauvegarde ou None en cas d'erreur.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="restore_prefs_file"><code>restore_prefs_file(backup_path: Union[str, Path], dest_path: Optional[Union[str, Path]] = None) -> bool</code></h4>
                <p class="description">Restaure un fichier de préférences à partir d'une sauvegarde.</p>
                <dl class="param-list">
                    <dt>backup_path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier de sauvegarde.</dd>
                    <dt>dest_path</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Chemin de destination ou None pour utiliser le chemin original.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la restauration réussit, False sinon.
                </div>
            </section>

            <h2 class="section-title">Politiques d'entreprise</h2>

            <section class="method-section">
                <h4 class="method-title"
                    id="read_policies_json"><code>read_policies_json(path: Union[str, Path]) -> Optional[Dict[str, Any]]</code></h4>
                <p class="description">Lit un fichier policies.json de Mozilla.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier policies.json.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Optional[Dict[str, Any]]</span> - Structure de politiques ou None en cas d'erreur.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="write_policies_json"><code>write_policies_json(path: Union[str, Path], policies: Dict[str, Any], backup: bool = True) -> bool</code></h4>
                <p class="description">Écrit un dictionnaire de politiques dans un fichier policies.json.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier policies.json.</dd>
                    <dt>policies</dt>
                    <dd><span class="param-type">(Dict[str, Any])</span>: Dictionnaire des politiques.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si l'écriture réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="configure_firefox_enterprise_policies"><code>configure_firefox_enterprise_policies(policies: Dict[str, Any], install_dir: Optional[Union[str, Path]] = None) -> bool</code></h4>
                <p class="description">Configure les politiques d'entreprise pour Firefox.</p>
                <p class="sudo-warning">Peut nécessiter des privilèges élevés selon l'emplacement d'installation.</p>
                <dl class="param-list">
                    <dt>policies</dt>
                    <dd><span class="param-type">(Dict[str, Any])</span>: Dictionnaire des politiques à configurer.</dd>
                    <dt>install_dir</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Répertoire d'installation de Firefox ou None pour utiliser l'emplacement par défaut.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la configuration réussit, False sinon.
                </div>
            </section>

            <h2 class="section-title">Fichiers de configuration .cfg</h2>

            <section class="method-section">
                <h4 class="method-title"
                    id="read_cfg_file"><code>read_cfg_file(path: Union[str, Path]) -> Optional[Dict[str, Dict[str, Any]]]</code></h4>
                <p class="description">Lit un fichier .cfg de Mozilla (format similaire à prefs.js mais avec lockPref, etc.).</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier .cfg.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Optional[Dict[str, Dict[str, Any]]]</span> - Dictionnaire des préférences ou None en cas d'erreur.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="write_cfg_file"><code>write_cfg_file(path: Union[str, Path], prefs: Dict[str, Dict[str, Any]], backup: bool = True) -> bool</code></h4>
                <p class="description">Écrit un dictionnaire de préférences dans un fichier .cfg.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier .cfg.</dd>
                    <dt>prefs</dt>
                    <dd><span class="param-type">(Dict[str, Dict[str, Any]])</span>: Dictionnaire des préférences {nom: {valeur: value, type: lockPref|defaultPref}}.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si l'écriture réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="add_lockpref_to_cfg"><code>add_lockpref_to_cfg(path: Union[str, Path], pref_name: str, value: Any, backup: bool = True) -> bool</code></h4>
                <p class="description">Ajoute une préférence verrouillée à un fichier .cfg.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier .cfg.</dd>
                    <dt>pref_name</dt>
                    <dd><span class="param-type">(str)</span>: Nom de la préférence à verrouiller.</dd>
                    <dt>value</dt>
                    <dd><span class="param-type">(Any)</span>: Valeur de la préférence.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si l'ajout réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="add_defaultpref_to_cfg"><code>add_defaultpref_to_cfg(path: Union[str, Path], pref_name: str, value: Any, backup: bool = True) -> bool</code></h4>
                <p class="description">Ajoute une préférence par défaut à un fichier .cfg.</p>
                <dl class="param-list">
                    <dt>path</dt>
                    <dd><span class="param-type">(Union[str, Path])</span>: Chemin du fichier .cfg.</dd>
                    <dt>pref_name</dt>
                    <dd><span class="param-type">(str)</span>: Nom de la préférence par défaut.</dd>
                    <dt>value</dt>
                    <dd><span class="param-type">(Any)</span>: Valeur de la préférence.</dd>
                    <dt>backup</dt>
                    <dd><span class="param-type">(bool)</span>: Si True, crée une sauvegarde du fichier original. Défaut: True.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si l'ajout réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="configure_autoconfig"><code>configure_autoconfig(install_dir: Optional[Union[str, Path]] = None) -> bool</code></h4>
                <p class="description">Configure l'autoconfiguration pour Firefox ou Thunderbird.</p>
                <p class="sudo-warning">Peut nécessiter des privilèges élevés selon l'emplacement d'installation.</p>
                <dl class="param-list">
                    <dt>install_dir</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Répertoire d'installation ou None pour utiliser l'emplacement par défaut.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la configuration réussit, False sinon.
                </div>
            </section>

            <h2 class="section-title">Configuration de Thunderbird</h2>

            <section class="method-section">
                <h4 class="method-title"
                    id="get_thunderbird_account_settings"><code>get_thunderbird_account_settings(profile_path: Optional[Union[str, Path]] = None) -> Dict[str, Dict[str, Any]]</code></h4>
                <p class="description">Récupère les paramètres de compte Thunderbird à partir du fichier prefs.js.</p>
                <dl class="param-list">
                    <dt>profile_path</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Chemin du profil Thunderbird ou None pour le rechercher automatiquement.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">Dict[str, Dict[str, Any]]</span> - Structure des paramètres de compte.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="set_thunderbird_account_setting"><code>set_thunderbird_account_setting(account_id: str, setting_type: str, setting_id: str, key: str, value: Any, profile_path: Optional[Union[str, Path]] = None) -> bool</code></h4>
                <p class="description">Définit un paramètre de compte Thunderbird.</p>
                <dl class="param-list">
                    <dt>account_id</dt>
                    <dd><span class="param-type">(str)</span>: ID du compte (ex: "account1").</dd>
                    <dt>setting_type</dt>
                    <dd><span class="param-type">(str)</span>: Type de paramètre ("identity" ou "server").</dd>
                    <dt>setting_id</dt>
                    <dd><span class="param-type">(str)</span>: ID du paramètre (ex: "id1" pour identity, "server1" pour server).</dd>
                    <dt>key</dt>
                    <dd><span class="param-type">(str)</span>: Clé du paramètre (ex: "useremail" pour identity, "hostname" pour server).</dd>
                    <dt>value</dt>
                    <dd><span class="param-type">(Any)</span>: Nouvelle valeur du paramètre.</dd>
                    <dt>profile_path</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Chemin du profil Thunderbird ou None pour le rechercher automatiquement.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la modification réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="configure_thunderbird_proxy"><code>configure_thunderbird_proxy(proxy_type: str, proxy_host: str, proxy_port: int, profile_path: Optional[Union[str, Path]] = None) -> bool</code></h4>
                <p class="description">Configure les paramètres de proxy pour Thunderbird.</p>
                <dl class="param-list">
                    <dt>proxy_type</dt>
                    <dd><span class="param-type">(str)</span>: Type de proxy ("none", "manual", "auto").</dd>
                    <dt>proxy_host</dt>
                    <dd><span class="param-type">(str)</span>: Hôte du proxy (pour "manual").</dd>
                    <dt>proxy_port</dt>
                    <dd><span class="param-type">(int)</span>: Port du proxy (pour "manual").</dd>
                    <dt>profile_path</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Chemin du profil Thunderbird ou None pour le rechercher automatiquement.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la configuration réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="configure_thunderbird_filters"><code>configure_thunderbird_filters(filters: List[Dict[str, Any]], profile_path: Optional[Union[str, Path]] = None) -> bool</code></h4>
                <p class="description">Configure les filtres de messagerie pour Thunderbird.</p>
                <dl class="param-list">
                    <dt>filters</dt>
                    <dd><span class="param-type">(List[Dict[str, Any]])</span>: Liste des filtres à configurer.</dd>
                    <dt>profile_path</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Chemin du profil Thunderbird ou None pour le rechercher automatiquement.</dd>
                </dl>
                <div class="return-info">
                    <span class="font-medium">Retourne:</span><span class="return-type">bool</span> - True si la configuration réussit, False sinon.
                </div>
            </section>

            <section class="method-section">
                <h4 class="method-title"
                    id="update_lightning_calendar"><code>update_lightning_calendar(ics_url: str, name: str, color: str = "#3366CC", profile_path: Optional[Union[str, Path]] = None) -> bool</code></h4>
                <p class="description">Ajoute ou met à jour un calendrier Lightning dans Thunderbird.</p>
                <dl class="param-list">
                    <dt>ics_url</dt>
                    <dd><span class="param-type">(str)</span>: URL du calendrier ICS.</dd>
                    <dt>name</dt>
                    <dd><span class="param-type">(str)</span>: Nom du calendrier.</dd>
                    <dt>color</dt>
                    <dd><span class="param-type">(str)</span>: Couleur du calendrier au format hexadécimal. Défaut: "#3366CC".</dd>
                    <dt>profile_path</dt>
                    <dd><span class="param-type">(Optional[Union[str, Path]])</span>: Chemin du profil Thunderbird ou None pour le rechercher automatiquement.</dd>
                </dl>
                <div class="return